<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Header Example</title>
    <!-- S·ª≠ d·ª•ng CDN c·ªßa Tailwind CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="texttovideo.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
  <style>
    .avatar {
      width: 4rem;
      height: 4rem;
      border-radius: 9999px;
      border: 2px solid rgb(0, 199, 152);
      object-fit: cover;
    }

    h1 {
      padding-top: 3%;
      font-family: "Gill Sans", "Gill Sans MT", Calibri, "Trebuchet MS",
        sans-serif;
    }

    h1:hover {
      color: #b8b7b9;
    }

    .sect {
      border: 2px solid whitesmoke;
      border-radius: 10px;
    }

    .text {
      text-align: center;
      width: 70%;
      font-size: 20px;
      padding-bottom: 10px;
    }
    /* From Uiverse.io by mrpumps31232 */
    .loading-wave {
      width: 300px;
      height: 100px;
      display: flex;
      justify-content: center;
      align-items: flex-end;
    }

    .loading-bar {
      width: 20px;
      height: 10px;
      margin: 0 5px;
      background-color: #0a9de2;
      border-radius: 5px;
      animation: loading-wave-animation 1s ease-in-out infinite;
    }

    .loading-bar:nth-child(2) {
      animation-delay: 0.1s;
    }

    .loading-bar:nth-child(3) {
      animation-delay: 0.2s;
    }

    .loading-bar:nth-child(4) {
      animation-delay: 0.3s;
    }

    @keyframes loading-wave-animation {
      0% {
        height: 10px;
      }

      50% {
        height: 50px;
      }

      100% {
        height: 10px;
      }
    }
    svg {
      width: 80%;
      height: 150px;
      margin-left: auto;
      margin-right: 50px;
    }

    .line {
      stroke: url(#grad1); /* üí° G·∫Øn gradient ƒë·ªông */
      stroke-width: 2;
      fill: none;
      stroke-linecap: round;
      stroke-linejoin: round;
      stroke-dasharray: 1000;
      stroke-dashoffset: 1000;
    }

    /* Glow effect */
    svg defs filter feGaussianBlur {
      stddeviation: 4;
    }
  </style>
  <body class="bg-gray-50">
    <!-- Header -->
    <nav
      style="background: #0a0425; background-size: cover"
      class="border-b border-gray-200"
    >
      <div class="max-w-screen-xl mx-auto px-4 py-4 flex items-center">
        <!-- C·ªôt 1: Logo + Brand -->
        <div class="flex items-center space-x-2 flex-shrink-0">
          <img
            style="border: 2px solid green"
            class="w-16 h-16 rounded-full object-cover"
            src="img_source/logo.png"
            alt="Logo"
          />
          <span
            style="
              background: linear-gradient(90deg, #00c6ff, #7d51f1, #a855f7);
              -webkit-background-clip: text;
              -webkit-text-fill-color: transparent;
            "
            class="text-xl font-bold"
          >
            AlchemistAI
          </span>
        </div>

        <!-- C·ªôt 2: Menu (·∫©n tr√™n mobile, hi·ªán khi md tr·ªü l√™n), flex:1 & justify-center ƒë·ªÉ cƒÉn gi·ªØa -->
        <div class="hidden md:flex flex-1 justify-center space-x-6">
          <a
            href="index.html"
            class="text-white font-extrabold hover:border-b-2 hover:text-green-300 pb-1 text-lg"
          >
            Home
          </a>
          <a
            href="texttospeech.html"
            class="text-white font-extrabold hover:border-b-2 hover:text-green-300 pb-1 text-lg"
          >
            Text to Speech
          </a>
          <a
            href="texttomusic.html"
            class="text-white font-extrabold hover:border-b-2 hover:text-green-300 pb-1 text-lg"
          >
            Text to Music
          </a>
          <a
            href="texttoimage.html"
            class="text-white font-extrabold hover:border-b-2 hover:text-green-300 pb-1 text-lg"
          >
            Text to Image
          </a>
          <a
            href="#"
            class="text-blue-600 font-extrabold border-b-2 border-blue-600 pb-1 hover:text-blue-700 text-lg"
          >
            Text to Video
          </a>
        </div>

        <!-- C·ªôt 3: Avatar + n√∫t Hamburger -->
        <div class="flex items-center justify-end space-x-4 ml-auto md:ml-0">
          <!-- Avatar ch·ªâ hi·ªÉn th·ªã tr√™n desktop -->
          <img
            class="avatar hidden md:block"
            src="img_source/ho.jpg"
            alt="avatar"
          />

          <!-- N√∫t hamburger (ch·ªâ hi·ªÉn th·ªã tr√™n mobile) -->
          <button
            class="md:hidden inline-flex items-center justify-end p-2 rounded text-white hover:bg-white hover:text-black"
            onclick="toggleMenu()"
          >
            <svg
              class="h-6 w-6"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 6h16M4 12h16M4 18h16"
              />
            </svg>
          </button>
        </div>
      </div>

      <!-- Menu d√†nh cho mobile (ban ƒë·∫ßu ·∫©n) -->
      <div class="md:hidden px-4 pb-3 hidden justify-end" id="mobileMenu">
        <a
          href="#"
          class="block text-white font-extrabold mt-2 hover:border-b-2 hover:text-green-300 pb-1 text-lg"
        >
          Home
        </a>
        <a
          href="texttospeech.html"
          class="block text-white font-extrabold mt-2 hover:border-b-2 hover:text-green-300 pb-1 text-lg"
        >
          Text to Speech
        </a>
        <a
          href="texttomusic.html"
          class="block text-white font-extrabold mt-2 hover:border-b-2 hover:text-green-300 pb-1 text-lg"
        >
          Text to Music
        </a>
        <a
          href="texttoimage.html"
          class="block text-white font-extrabold mt-2 hover:border-b-2 hover:text-green-300 pb-1 text-lg"
        >
          Text to Image
        </a>
        <a
          href="#"
          class="block text-blue-600 font-extrabold border-b-2 border-blue-600 mt-2 pb-1 hover:text-blue-700 text-lg"
        >
          Text to Video
        </a>
        <!-- Avatar tr√™n mobile (n·∫øu mu·ªën hi·ªÉn th·ªã ·ªü menu) -->
      </div>
    </nav>
    <main
      style="
        background: url('img_source/nenVideo.jpg') no-repeat center center fixed;
        background-size: cover;
      "
      class="min-h-screen flex flex-col items-center justify-start bg-gray-900 text-gray-100 space-y-4"
    >
      <h1 class="text-3xl sm:text-4xl md:text-5xl font-bold mb-4">
        Text To Video
      </h1>
      <div class="text mb-4">
        Turn your ideas into unique videos. Enter text, choose a genre, and let
        AI create an amazing video.
      </div>
      <div class="max-w-7xl w-full bg-gray-800 p-4 rounded-lg shadow-md">
        <div class="flex items-center justify-between mb-4">
          <span class="text-sm md:text-base px-3 py-2 font-bold">
            Text to Video
          </span>

          <!-- Credits g√≥c ph·∫£i -->
        </div>
        <textarea
          id="prompt"
          class="w-full bg-gray-700 p-3 rounded-md resize-none text-sm md:text-base border border-gray-700 hover:border-purple-400 transition-colors focus:outline-none focus:ring-2 focus:ring-purple-400"
          rows="5"
          maxlength="200"
          placeholder="Enter your idea..."
        ></textarea>
        <div class="flex gap-4 mt-4">
          <!-- C·ªôt 1: Style -->
          <div class="w-2/3 flex flex-col">
            <label class="font-semibold mb-1">Style</label>
            <select
              class="w-full border border-gray-300 rounded-md p-2 text-black"
            >
              <option>Realistic</option>
              <option>Animated</option>
              <option>Documentary</option>
            </select>
          </div>

          <!-- C·ªôt 2: Time -->
          <!--
          <div class="w-2/5 flex flex-col">
            <label class="font-semibold mb-1">Duration (minutes)</label>
            <input
              id="durationRange"
              type="range"
              min="5"
              max="10"
              step="0.5"
              value="2"
              class="w-full"
            />
            <span id="durationDisplay" className="text-sm text-gray-500"
              >{duration} second</span
            >
          </div>
          -->
          <div class="w-1/3">
            <div class="flex justify-center mt-5">
              <button
                onclick="SendPrompt()"
                class="w-full max-w-xs h-12 px-4 bg-gradient-to-r from-pink-500 via-red-500 to-yellow-400 text-white font-bold text-base rounded-full shadow-md transition-all duration-300 ease-in-out transform hover:scale-105 hover:shadow-xl flex items-center justify-center gap-x-2 whitespace-nowrap"
              >
                üìΩÔ∏è Generate
              </button>
            </div>
          </div>
        </div>
        <div class="relative flex items-center gap-4 mt-6">
          <svg class="w-4/5" viewBox="0 0 304 112">
            <defs>
              <!-- Linear gradient chuy·ªÉn ƒë·ªông -->
              <linearGradient id="grad1" x1="0%" y1="0%" x2="100%" y2="0%">
                <stop offset="0%" stop-color="#00ff">
                  <animate
                    attributeName="offset"
                    values="-1;1"
                    dur="2s"
                    repeatCount="indefinite"
                  />
                </stop>
                <stop offset="50%" stop-color="#ffffff" stop-opacity="1">
                  <animate
                    attributeName="offset"
                    values="0;2"
                    dur="2s"
                    repeatCount="indefinite"
                  />
                </stop>
                <stop offset="100%" stop-color="#00ffe7">
                  <animate
                    attributeName="offset"
                    values="1;3"
                    dur="2s"
                    repeatCount="indefinite"
                  />
                </stop>
              </linearGradient>
            </defs>
            <g stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
              <path
                class="line"
                d="M59 90V56.136C58.66 46.48 51.225 39 42 39c-9.389 0-17 7.611-17 17s7.611 17 17 17h8.5v17H42C23.222 90 8 74.778 8 56s15.222-34 34-34c18.61 0 33.433 14.994 34 33.875V90H59z"
              />
              <polyline
                class="line"
                points="59 22.035 59 90 76 90 76 22 59 22"
              />
              <path
                class="line"
                d="M59 90V55.74C59.567 36.993 74.39 22 93 22c18.778 0 34 15.222 34 34v34h-17V56c0-9.389-7.611-17-17-17-9.225 0-16.66 7.48-17 17.136V90H59z"
              />
              <polyline
                class="line"
                points="127 22.055 127 90 144 90 144 22 127 22"
              />
              <path
                class="line"
                d="M127 90V55.74C127.567 36.993 142.39 22 161 22c18.778 0 34 15.222 34 34v34h-17V56c0-9.389-7.611-17-17-17-9.225 0-16.66 7.48-17 17.136V90h-17z"
              />
              <path
                class="line"
                d="M118.5 22a8.5 8.5 0 1 1-8.477 9.067v-1.134c.283-4.42 3.966-7.933 8.477-7.933z"
              />
              <path
                class="line"
                d="M144 73c-9.389 0-17-7.611-17-17v-8.5h-17V56c0 18.778 15.222 34 34 34V73z"
              />
              <path
                class="line"
                d="M178 90V55.74C178.567 36.993 193.39 22 212 22c18.778 0 34 15.222 34 34v34h-17V56c0-9.389-7.611-17-17-17-9.225 0-16.66 7.48-17 17.136V90h-17z"
              />
              <path
                class="line"
                d="M263 73c-9.389 0-17-7.611-17-17s7.611-17 17-17c9.18 0 16.58 7.4 17 17h-17v17h34V55.875C296.433 36.994 281.61 22 263 22c-18.778 0-34 15.222-34 34s15.222 34 34 34V73z"
              />
              <path
                class="line"
                d="M288.477 73A8.5 8.5 0 1 1 280 82.067v-1.134c.295-4.42 3.967-7.933 8.477-7.933z"
              />
              <path class="line" d="M59 90V56.136C58.66 46.48..." />
              <polyline class="line" points="..." />
              <path
                class="line"
                d="M59 90V56.136C58.66 46.48 51.225 39 42 39c-9.389 0-17 7.611-17 17s7.611 17 17 17h8.5v17H42C23.222 90 8 74.778 8 56s15.222-34 34-34c18.61 0 33.433 14.994 34 33.875V90H59z"
              />
              <polyline
                class="line"
                points="59 22.035 59 90 76 90 76 22 59 22"
              />
              <path
                class="line"
                d="M59 90V55.74C59.567 36.993 74.39 22 93 22c18.778 0 34 15.222 34 34v34h-17V56c0-9.389-7.611-17-17-17-9.225 0-16.66 7.48-17 17.136V90H59z"
              />
              <polyline
                class="line"
                points="127 22.055 127 90 144 90 144 22 127 22"
              />
              <path
                class="line"
                d="M127 90V55.74C127.567 36.993 142.39 22 161 22c18.778 0 34 15.222 34 34v34h-17V56c0-9.389-7.611-17-17-17-9.225 0-16.66 7.48-17 17.136V90h-17z"
              />
              <path
                class="line"
                d="M118.5 22a8.5 8.5 0 1 1-8.477 9.067v-1.134c.283-4.42 3.966-7.933 8.477-7.933z"
              />
              <path
                class="line"
                d="M144 73c-9.389 0-17-7.611-17-17v-8.5h-17V56c0 18.778 15.222 34 34 34V73z"
              />
              <path
                class="line"
                d="M178 90V55.74C178.567 36.993 193.39 22 212 22c18.778 0 34 15.222 34 34v34h-17V56c0-9.389-7.611-17-17-17-9.225 0-16.66 7.48-17 17.136V90h-17z"
              />
              <path
                class="line"
                d="M263 73c-9.389 0-17-7.611-17-17s7.611-17 17-17c9.18 0 16.58 7.4 17 17h-17v17h34V55.875C296.433 36.994 281.61 22 263 22c-18.778 0-34 15.222-34 34s15.222 34 34 34V73z"
              />
              <path
                class="line"
                d="M288.477 73A8.5 8.5 0 1 1 280 82.067v-1.134c.295-4.42 3.967-7.933 8.477-7.933z"
              />
            </g>
          </svg>
          <div
            id="mini-loader"
            class="absolute right-20 top-1/2 -translate-y-1/2 flex gap-2 items-end hidden"
          >
            <span class="dot"></span>
            <span class="dot delay-1"></span>
            <span class="dot delay-2"></span>
          </div>
        </div>
      </div>
      <div class="max-w-7xl w-full bg-gray-800 p-4 rounded-lg shadow-md">
        <div class="flex items-center justify-between mb-4">
          <span class="text-sm md:text-base px-3 py-2 font-bold"> Result </span>
        </div>
        <div
          id="video-list"
          class="max-h-250 overflow-y-auto space-y-4 bg-gray-50 p-4 rounded-lg shadow"
        ></div>
      </div>
    </main>
    <script>
      //const slider = document.getElementById("durationRange");
      //const display = document.getElementById("durationDisplay");

      // C·∫≠p nh·∫≠t gi√° tr·ªã khi ng∆∞·ªùi d√πng k√©o
      //slider.addEventListener("input", function () {
      //display.textContent = `${slider.value} second`;
      //});

      // Hi·ªÉn th·ªã gi√° tr·ªã ban ƒë·∫ßu
      //display.textContent = `${slider.value} second`;
    </script>
    <script>
      anime({
        targets: ".line",
        strokeDashoffset: [anime.setDashoffset, 0],
        easing: "easeInOutSine",
        duration: 2000,
        delay: anime.stagger(100),
        direction: "alternate",
        loop: true,
      });
    </script>
    <script>
      async function SendPrompt() {
        const loader = document.getElementById("mini-loader");
        const prompt = document.getElementById("prompt").value.trim();
        const videoList = document.getElementById("video-list");

        const style = document.querySelector("select").value;
        //const duration = document.getElementById("durationRange").value;

        const username = localStorage.getItem("username");

        if (!prompt) {
          alert("Vui l√≤ng nh·∫≠p n·ªôi dung tr∆∞·ªõc khi t·∫°o video.");
          return;
        }

        loader.classList.remove("hidden");

        try {
          const response = await fetch(
            "http://localhost:5555/api/texttovideo",
            {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({ username, prompt, style }),
            }
          );

          const data = await response.json();
          if (data.success) {
            const videoUrl = data.file_path;

            const videoElement = document.createElement("video");
            videoElement.src = videoUrl;
            videoElement.controls = true;
            videoElement.classList.add("w-full", "rounded-md", "shadow-md");

            const label = document.createElement("p");
            label.textContent = `${videoUrl
              .split("/")
              .pop()} - ${new Date().toLocaleString()}`;
            label.classList.add("text-sm", "text-gray-700");

            const wrapper = document.createElement("div");
            wrapper.classList.add("mb-4");
            wrapper.appendChild(label);
            wrapper.appendChild(videoElement);

            videoList.prepend(wrapper);
            while (videoList.childNodes.length > 5) {
              videoList.removeChild(videoList.lastChild);
            }
          } else {
            alert("L·ªói t·∫°o video: " + data.error);
          }
        } catch (error) {
          console.error("L·ªói khi g·ª≠i y√™u c·∫ßu:", error);
        } finally {
          loader.classList.add("hidden");
        }
      }
    </script>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const username = localStorage.getItem("username");
        if (!username) {
          alert("Ch∆∞a ƒëƒÉng nh·∫≠p! Vui l√≤ng ƒëƒÉng nh·∫≠p l·∫°i.");
          window.location.href = "/frontend/Sign_in.html";
          return;
        }

        fetch(`http://localhost:5555/api/get_ttv_data?username=${username}`)
          .then((res) => res.json())
          .then((data) => {
            const videoList = document.getElementById("video-list");
            videoList.innerHTML = "";

            if (data.success && data.ttv_data.length > 0) {
              data.ttv_data.forEach((video, index) => {
                // Container ch·ª©a c·∫£ video + th√¥ng tin
                const wrapper = document.createElement("div");
                wrapper.className = "flex bg-white rounded shadow p-4 mb-4";

                // VIDEO b√™n tr√°i
                const videoEl = document.createElement("video");
                videoEl.src = `http://localhost:5555/${video.result}`;
                videoEl.controls = true;
                videoEl.className = "w-1/4 rounded"; // 1/4 chi·ªÅu r·ªông

                // TH√îNG TIN b√™n ph·∫£i
                const info = document.createElement("div");
                info.className = "ml-4 flex flex-col justify-center w-3/4";

                const title = document.createElement("p");
                title.className = "text-base font-semibold text-gray-800";
                title.textContent = `Video ${index + 1}: ${video.input_text}`;

                const meta = document.createElement("p");
                meta.className = "text-sm text-gray-600";
                meta.textContent = `Style: ${video.style}`;

                info.appendChild(title);
                info.appendChild(meta);

                // G·ªôp l·∫°i
                wrapper.appendChild(videoEl);
                wrapper.appendChild(info);
                videoList.appendChild(wrapper);
              });
            } else {
              videoList.innerHTML =
                "<p class='text-gray-500'>Ch∆∞a c√≥ video n√†o ƒë∆∞·ª£c t·∫°o.</p>";
            }
          })
          .catch((error) => {
            console.error("L·ªói khi l·∫•y video:", error);
            document.getElementById("video-list").innerHTML =
              "<p class='text-red-500'>L·ªói khi t·∫£i video.</p>";
          });
      });
    </script>
  </body>
</html>
